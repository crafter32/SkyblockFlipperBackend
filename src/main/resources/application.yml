spring:
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://db:5432/skyblock}
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${SPRING_DATASOURCE_PASSWORD}

  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false

  flyway:
    enabled: true
    locations: classpath:db/migration
    validate-on-migrate: true
    baseline-on-migrate: ${FLYWAY_BASELINE_ON_MIGRATE:false}

server:
  port: ${SERVER_PORT:1880}

config:
  hypixel:
    api-url: ${CONFIG_HYPIXEL_API_URL:https://api.hypixel.net/v2}
    api-key: ${CONFIG_HYPIXEL_API_KEY:}
    adaptive:
      enabled: ${CONFIG_HYPIXEL_ADAPTIVE_ENABLED:true}
      global-max-requests-per-second: ${CONFIG_HYPIXEL_ADAPTIVE_GLOBAL_MAX_RPS:3.0}
      auctions:
        name: auctions
        path: /skyblock/auctions
        period-hint: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_PERIOD_HINT:PT20S}
        warmup-interval: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_WARMUP_INTERVAL:PT2S}
        warmup-max-seconds: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_WARMUP_MAX_SECONDS:90}
        guard-window-ms: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_GUARD_WINDOW_MS:400}
        min-guard-window-ms: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_MIN_GUARD_WINDOW_MS:250}
        max-guard-window-ms: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_MAX_GUARD_WINDOW_MS:1200}
        burst-interval-ms: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_BURST_INTERVAL_MS:500}
        burst-window-ms: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_BURST_WINDOW_MS:4000}
        backoff-interval: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_BACKOFF_INTERVAL:PT2S}
        max-burst-rate: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_MAX_BURST_RATE:2.0}
        request-timeout: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_REQUEST_TIMEOUT:PT8S}
        connect-timeout: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_CONNECT_TIMEOUT:PT2S}
        estimator-window-size: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_ESTIMATOR_WINDOW_SIZE:7}
        ema-alpha: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_EMA_ALPHA:0.25}
        min-period-multiplier: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_MIN_PERIOD_MULTIPLIER:0.6}
        max-period-multiplier: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_MAX_PERIOD_MULTIPLIER:1.8}
        transient-retries: ${CONFIG_HYPIXEL_ADAPTIVE_AUCTIONS_TRANSIENT_RETRIES:2}
      bazaar:
        name: bazaar
        path: /skyblock/bazaar
        period-hint: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_PERIOD_HINT:PT60S}
        warmup-interval: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_WARMUP_INTERVAL:PT2S}
        warmup-max-seconds: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_WARMUP_MAX_SECONDS:90}
        guard-window-ms: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_GUARD_WINDOW_MS:400}
        min-guard-window-ms: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_MIN_GUARD_WINDOW_MS:250}
        max-guard-window-ms: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_MAX_GUARD_WINDOW_MS:1200}
        burst-interval-ms: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_BURST_INTERVAL_MS:500}
        burst-window-ms: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_BURST_WINDOW_MS:4000}
        backoff-interval: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_BACKOFF_INTERVAL:PT2S}
        max-burst-rate: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_MAX_BURST_RATE:2.0}
        request-timeout: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_REQUEST_TIMEOUT:PT8S}
        connect-timeout: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_CONNECT_TIMEOUT:PT2S}
        estimator-window-size: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_ESTIMATOR_WINDOW_SIZE:7}
        ema-alpha: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_EMA_ALPHA:0.25}
        min-period-multiplier: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_MIN_PERIOD_MULTIPLIER:0.6}
        max-period-multiplier: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_MAX_PERIOD_MULTIPLIER:1.8}
        transient-retries: ${CONFIG_HYPIXEL_ADAPTIVE_BAZAAR_TRANSIENT_RETRIES:2}
      pipeline:
        queue-capacity: ${CONFIG_HYPIXEL_ADAPTIVE_PIPELINE_QUEUE_CAPACITY:1}
        coalesce-enabled: ${CONFIG_HYPIXEL_ADAPTIVE_PIPELINE_COALESCE_ENABLED:true}
    polling:
      auctions-base-interval: ${CONFIG_HYPIXEL_POLL_AUCTIONS_BASE_INTERVAL:PT60S}
      bazaar-base-interval: ${CONFIG_HYPIXEL_POLL_BAZAAR_BASE_INTERVAL:PT20S}
      max-interval-multiplier: ${CONFIG_HYPIXEL_POLL_MAX_INTERVAL_MULTIPLIER:2}
      retry-interval: ${CONFIG_HYPIXEL_POLL_RETRY_INTERVAL:PT10S}
  NEU:
    repo-url: ${CONFIG_NEU_REPO_URL:https://github.com/NotEnoughUpdates/NotEnoughUpdates-REPO}
    refresh-days: ${CONFIG_NEU_REFRESH_DAYS:1}
  snapshot:
    retention:
      raw-window-seconds: ${CONFIG_SNAPSHOT_RETENTION_RAW_WINDOW_SECONDS:90}
      minute-tier-upper-seconds: ${CONFIG_SNAPSHOT_RETENTION_MINUTE_TIER_UPPER_SECONDS:1800}
      two-hour-tier-upper-seconds: ${CONFIG_SNAPSHOT_RETENTION_TWO_HOUR_TIER_UPPER_SECONDS:43200}
      minute-interval-seconds: ${CONFIG_SNAPSHOT_RETENTION_MINUTE_INTERVAL_SECONDS:60}
      two-hour-interval-seconds: ${CONFIG_SNAPSHOT_RETENTION_TWO_HOUR_INTERVAL_SECONDS:7200}

instrumentation:
  jfr:
    enabled: ${INSTRUMENTATION_JFR_ENABLED:true}
    output-dir: ${INSTRUMENTATION_JFR_OUTPUT_DIR:var/profiling/jfr}
    retention: ${INSTRUMENTATION_JFR_RETENTION:PT2H}
    max-size-mb: ${INSTRUMENTATION_JFR_MAX_SIZE_MB:512}
    stack-depth: ${INSTRUMENTATION_JFR_STACK_DEPTH:256}
    snapshot-window: ${INSTRUMENTATION_JFR_SNAPSHOT_WINDOW:PT2M}
  blocking:
    slow-threshold-millis: ${INSTRUMENTATION_BLOCKING_SLOW_THRESHOLD_MILLIS:100}
    stack-sample-rate: ${INSTRUMENTATION_BLOCKING_STACK_SAMPLE_RATE:0.01}
    stack-log-rate-limit: ${INSTRUMENTATION_BLOCKING_STACK_LOG_RATE_LIMIT:PT30S}
  admin:
    local-only: ${INSTRUMENTATION_ADMIN_LOCAL_ONLY:true}
    token: ${INSTRUMENTATION_ADMIN_TOKEN:}
  async-profiler:
    enabled: ${INSTRUMENTATION_ASYNC_PROFILER_ENABLED:false}
    output-dir: ${INSTRUMENTATION_ASYNC_PROFILER_OUTPUT_DIR:var/profiling/async-profiler}
    script-path: ${INSTRUMENTATION_ASYNC_PROFILER_SCRIPT_PATH:scripts/run_async_profiler.sh}
